# Per Node Retention Index Calculation #

To evaluate indel characters on the avian phylogeny, we sought to determine RI values of indel characters on the internal nodes of various avian trees.
The following three steps were used to accomplish this.

### RI values with TNT ###

The 'apo' command in TNT can list synapomorphic characters for each node on a given tree. On the TNT shell, type 'help apo;' to see the options.

Secondly, a custom TNT script, aporis.run (adapted from apocis.run which is available with TNT package), can be used to calculate and list RI values of all characters in a matrix, given a tree.

We used the 'apo' functionality in conjunction with aporis.run to generate two files:

* A list of synapomorphic characters categorized by each node on a given tree ('apo' command)
* RI of each character based on the same tree (aporis.run)

These two steps are combined into one shell script - fulltntstats.sh. 
This script also generates other useful output like tree with branchlengths ('blen' command), ensemble RI and CI (with stats.run).

To use the script, call
	
	$ bash fulltntstats.sh -h
	
to see how to use it and it's requirements.

### charRI.py ###

The 'apo' and 'aporis' output from the previous step is then used to generate a list of synapomorphic characters with their RI values, categorized by node.
This is done using the charRI,py python3 script.

The script has two arguments - paths to files containing the apo and aporis output. 
The output of the python3 script is to standard out, so you should pipe the output to a suitable file.

### nodestats.py ###

Given a file generated by the previous script, charRI.py, the nodestats.py pythron3 script summarizes three values for each node:

* Total number of synapomorphic characters
* Average RI of synapomorphic characters
* Proportion of characters with RI=1.0

This script outputs to standard out, so you should pipe the output to a suitable file.